#custom terminal welcome & prompt
greeting=("\rWelcome back! ğŸ‘‹                                                                                     " "\rGlad to see you again! ğŸ˜„                                                                                     " "\rLong time, no see. ğŸ™ˆ                                                                                     " "\rAt your service! ğŸ’ª                                                                                     " "\rLet's get hackin' ğŸ‘¨â€ğŸ’»                                                                                  " "\rOooh yeah, it's on! ğŸ˜                                                                                     " "\rSummoned me? ğŸ–                                                                                     ")
echo ${greeting[$(( $RANDOM % ${#greeting[@]} + 1 ))]}
PROMPT='%(?:ğŸ”¥:ğŸ’©) '

export LSCOLORS=Hxfxcxdxbxegedabagacad
export CLICOLOR_FORCE=1
export PATH="/usr/local/sbin:$PATH"

# ---------
#  ALIASES
# ---------

alias please='sudo $(fc -ln -1)'
alias thanks='echo "â†’ No problem ğŸ‘"' 
alias speedtest='speedtest --simple --secure; printf \\a'
#alias ls="ls -FlGh | awk '{print \$5, \"\t\", \$9, \" \"}'"
alias pingtest='ping 8.8.8.8'
alias pping='pingtest'
alias pingtestalert='ping 8.8.8.8 -a'
alias ppinga='pingtestalert'
alias notify='ring bell'

### Functions â†“
#custom greetings
#GREETINGS = ("Welcome back!" "Heya!" "Hello" "Howdy, boy!" "Long time, no see")
#EMOJIS = (ğŸ™Œ ğŸ¤˜ ğŸ‘‹ âœŒï¸  ğŸ˜˜ â¤ï¸);

# ---------
# FUNCTIONS
# ---------

covid19() {
    if [[ $# == 0 ]]; then
	command curl https://corona-stats.online/
    else
	command curl https://corona-stats.online/$1
    fi
}
dont() {
        if [[ $@ == "sleep" ]]; then
                command caffeinate -d
        else
                command echo "don't what? sleep? Ã°Â¤Â·<200d>Ã¢Â‚Ã¯Â "
        fi
}
hello() {
    echo "Hi! ğŸ‘‹"
}
hey() {
    echo "Hello! ğŸ‘‹"
}
hi() {
    echo "Hey! ğŸ‘‹"
}
hide() {
    if [[ $@ == "hidden" ]]; then
        command defaults write com.apple.finder AppleShowAllFiles FALSE; killall Finder
    else
        command echo "maybe use 'hide hidden'?"
    fi
}
ls() {
	# directory size does not include contents, only the directory itself
	# try something like 'du -h *' to list directory + contents size
        command ls -FlGh $@ | awk '{print $5, "\t", $9, " "}'
}
make() {
        if [[ $@ == "server" ]]; then
                command echo "running webserver on localhost:8000"
                command php -S localhost:8000
        else
                command $@
        fi
}
play() {
        if [[ $@ == "starwars" ]]; then
                command nc towel.blinkenlights.nl 23
        else
                command echo "try 'play starwars' ğŸ˜‰"
        fi
}
ring() {
    if [[ $@ == "bell" ]]; then
            command afplay /System/Library/Sounds/Glass.aiff
    else
            echo "Ring what? A bell?"
    fi
}
screensaver() {
	command caffeinate -d open -a ScreenSaverEngine
}
show() {
	if [[ $@ == "hidden" ]]; then
        	command defaults write com.apple.finder AppleShowAllFiles TRUE; killall Finder
	else
        	command echo "maybe use 'show hidden'?"
	fi
}
spinner() {
	spin="â ‹â ™â ¹â ¸â ¼â ´â ¦â §â ‡â "
	let "condition = -1"
	let "zero = 0"
	if [[ $1 > -1 ]]; then
			let "condition = $1 * 2"
	fi
	while (( 0 != $condition )) {
		for (( i=0; i<${#spin}; i++ )); do
			printf "\r${spin:$i:1} "; sleep 0.05;
		done
		printf "\r "
		((condition=condition-1))
	}
	printf "\r"
}
timer() {
    # TODO:	move forking and killing commands to spinner function
    #	    also replace "pid=$( sleep $time" with "pid=$( spinner $time"

	let time=$1;
	if [[ $2 == s* ]]; then
		echo "timer for $time seconds"
	fi
	if [[ $2 == m* ]]; then
		echo "timer for $time minutes"
		time=time*60;
	fi

	{ pid=$( sleep $time >&3 & echo $! ); } 3>&1
	
	while kill -0 "$pid" 2> /dev/null; do
		spinner $time;			
        done 
        printf '\r'; printf \\a;
}
